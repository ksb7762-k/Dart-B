## 4.2.5 가중회귀 (Weighted Least Squares, WLS)

### ✅ 정의
- **가중회귀**는 관측치마다 **중요도(가중치)** 를 달리하여 회귀모형을 적합시키는 방법
- 일반적인 OLS(Ordinary Least Squares)가 모든 관측치에 **동일한 가중치**를 주는 것과 다름

---

### ✅ 언제 사용하는가
- **등분산성 가정이 깨진 경우** (즉, 오차의 분산이 일정하지 않은 경우 = 이분산성)
- 예시 상황:
  - 오차가 x값이 클수록 점점 커짐 (이분산성)
  - 측정값의 **신뢰도가 다를 때** (측정 정밀도 차이)
  - 특정 그룹의 관측치를 **더 중요하게 반영**하고 싶을 때

---

### ✅ 왜 사용하는가
- OLS는 등분산성을 가정하므로, 이분산이 존재하면 **비효율적**이고 추정량이 **신뢰할 수 없음**
- WLS는 **오차 분산이 작은 관측치에 더 많은 가중치**를 주어 **효율적 추정**을 가능하게 함
- 가중치가 오차 분산의 역수일 때, **최소분산 불편 추정량**이 됨

---
**하지만**  이분산성이 있어도 가중회귀는 잘 안 씀  


- 이론적으로는 이분산 → WLS가 맞지만
- **실무나 필드에서는 WLS보다 더 견고하고 직관적인 방법들**을 선택
  - 로버스트 회귀, 로그변환, 부트스트랩 등이 대표적

→ WLS는 **이론상 이상적이지만, 실제로는 불편하고 제약이 많아서 잘 안 쓰는 기법**